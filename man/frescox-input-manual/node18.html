<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2021 (Released January 1, 2021) -->
<HTML lang="en">
<HEAD>
<TITLE>Appendix VI : Search version SFRESCO</TITLE>
<META NAME="description" CONTENT="Appendix VI : Search version SFRESCO">
<META NAME="keywords" CONTENT="frescox-input-manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2021">

<LINK REL="STYLESHEET" HREF="frescox-input-manual.css">

<LINK REL="next" HREF="node20.html">
<LINK REL="previous" HREF="node17.html">
<LINK REL="next" HREF="node19.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node19.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="frescox-input-manual.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node17.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A
 HREF="node19.html">SFresco Input</A>
<B> Up:</B> <A
 HREF="frescox-input-manual.html">Fresco</A>
<B> Previous:</B> <A
 HREF="node17.html">Appendix V : KIND=1</A>
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00080000000000000000">
Appendix VI : Search version SF<SMALL>RESCO</SMALL></A>
</H1><SPAN CLASS="SPAN"><SPAN CLASS="LARGE">
</SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE">This is an program which search for a <SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img231.svg"
 ALT="$\chi^2$"></SPAN> minimum when comparing
the outputs of FRESCO with sets of data, using the M<SMALL>INUIT</SMALL> search
routines.
</SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE">The inputs for SF<SMALL>RESCO</SMALL> specify the FRESCO input and output files,
the number and types of search variables, and the experimental data sets.
</SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE">A <SPAN style="font-family:monospace">search_file</SPAN> format is defined as follows:
</SPAN></SPAN><PRE>
Card 1:
(2*string, 2*integer: free format)
input_file, output_file, nvariables, ndatasets
</PRE><SPAN CLASS="SPAN"><SPAN CLASS="LARGE">
</SPAN></SPAN>
<P></P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"><SPAN style="font-family:monospace">input_file</SPAN>: name of file (in single quotes) with regular FRESCO input
<BR><SPAN style="font-family:monospace">output_file</SPAN>: name of file for the final FRESCO output
<BR><SPAN style="font-family:monospace">nvariables</SPAN>: number of search variables
<BR><SPAN style="font-family:monospace">ndatasets</SPAN>:  number of experimental data sets.
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE">Repeated <SPAN style="font-family:monospace">nvariables</SPAN> times, a namelist with some of the following variables:
</SPAN></SPAN><PRE>
Card 2: (namelist: 'variable')
name,kind,step,valmin,valmax, kp,pline,col,potential,
dataset,datanorm,dataEshift,reffile, nafrac,afrac,
energy, damp, jtot,par,channel,width,rwa, leff
</PRE><SPAN CLASS="SPAN"><SPAN CLASS="LARGE">
<SPAN style="font-family:monospace">name</SPAN> is name of variable (up to 10 characters),
<BR><SPAN style="font-family:monospace">kind</SPAN>: 0=ignore, 1=potential, 2=afrac, 3=R-matrix energy,
<BR>
4=R-mat partial width, 5=dataset normalisation
<BR><SPAN style="font-family:monospace">step</SPAN>: step size for finding derivatives etc, zero for fixed. (default 0.01)
<BR><SPAN style="font-family:monospace">valmin</SPAN>: strict lower bound (if non-zero),
<BR><SPAN style="font-family:monospace">valmax</SPAN>: strict upper bound (if non-zero), 
<BR><SPAN style="font-family:monospace">null</SPAN>: (default -124578) `undefined' value,
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"><SPAN style="font-family:monospace">kind=</SPAN><B>1: Variable potential parameter:</B>
<BR><SPAN style="font-family:monospace">kp</SPAN>: number of potential as on Card 10,
<BR><SPAN style="font-family:monospace">pline</SPAN>: order of which Card 10 within potential definition,
<BR><SPAN style="font-family:monospace">col</SPAN>:   number on Card 10: selecting P0&ndash;P7 ,
<BR><SPAN style="font-family:monospace">potential</SPAN>: value of this potential parameter (default <SPAN style="font-family:monospace">null</SPAN>: use <SPAN style="font-family:monospace">input_file</SPAN>)
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"><SPAN style="font-family:monospace">kind=</SPAN><B>2: Variable spectroscopic amplitude:</B>
<BR><SPAN style="font-family:monospace">nafrac</SPAN>: order number of Cards 17 in <SPAN style="font-family:monospace">input_file</SPAN>
<BR><SPAN style="font-family:monospace">afrac</SPAN>: spectroscopic amplitude A (default <SPAN style="font-family:monospace">null</SPAN>: use <SPAN style="font-family:monospace">input_file</SPAN>)
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"><SPAN style="font-family:monospace">kind=</SPAN><B>3: Variable energy of R-matrix term:</B>
<BR><SPAN style="font-family:monospace">term</SPAN>: term number (default 1)
<BR><SPAN style="font-family:monospace">jtot</SPAN>: J value for additional R-matrix term
<BR><SPAN style="font-family:monospace">par</SPAN>: parity (+1 or &ndash;1)
<BR><SPAN style="font-family:monospace">energy</SPAN>: energy (cm MeV in entrance channel) of additional R-matrix term (default 0)
<BR><SPAN style="font-family:monospace">damp</SPAN>: energy (cm MeV in entrance channel) of imaginary width of this R-matrix term (default 0). The actual  imaginary part is <SPAN style="font-family:monospace">damp</SPAN>/2
<BR><SPAN style="font-family:monospace">nopot</SPAN>: Disable potential &amp; Buttle correction for this J/pi set (logical T or F, default F)
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"><SPAN style="font-family:monospace">kind=</SPAN><B>4: Variable partial width of R-matrix term:</B>
<BR><SPAN style="font-family:monospace">channel</SPAN>: channel number (in order generated by FRESCO)
<BR><SPAN style="font-family:monospace">term</SPAN>: term number (default 1)
<BR><SPAN style="font-family:monospace">rwa</SPAN>: the <SPAN style="font-family:monospace">width</SPAN> is reduced width amplitude <SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img256.svg"
 ALT="$\gamma$"></SPAN>, else <!-- MATH
 $\Gamma=2\gamma^2 P$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img257.svg"
 ALT="$\Gamma=2\gamma^2 P$"></SPAN>.  (default T)
<BR><SPAN style="font-family:monospace">B</SPAN>: the boundary condition <SPAN style="font-family:monospace">B</SPAN>. (Default: from <SPAN style="font-family:monospace">BNDX</SPAN>).
<BR><SPAN style="font-family:monospace">width</SPAN>: width for this channel (MeV<SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img258.svg"
 ALT="$^{1/2}$"></SPAN> if <SPAN style="font-family:monospace">rwa</SPAN> or energy subthreshold, else MeV(cm)) (default 0)
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"><SPAN style="font-family:monospace">kind=</SPAN><B>5: Variable dataset normalisation:</B>
<BR><SPAN style="font-family:monospace">dataset(1:2)</SPAN>: index (or, first and last, inclusive) of which dataset (1 to <SPAN style="font-family:monospace">ndatasets</SPAN>) (default 1), or
<BR><SPAN style="font-family:monospace">reffile</SPAN>: filename of dataset. If has a `*', renorm all sets with names matching up to that character,
<BR><SPAN style="font-family:monospace">datanorm</SPAN>: search on absolute normalisation factor of this dataset and its error (default: 1.0)
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"><SPAN style="font-family:monospace">kind=</SPAN><B>6: Variable dataset energy shift:</B>
<BR><SPAN style="font-family:monospace">dataset(1:2)</SPAN>: index (or, first and last, inclusive) of which dataset (1 to <SPAN style="font-family:monospace">ndatasets</SPAN>) (default 1), or
<BR><SPAN style="font-family:monospace">reffile</SPAN>: filename of dataset. If has a  `*', shift all sets with names matching  up to that character,
<BR><SPAN style="font-family:monospace">dataEshift</SPAN>: search on absolute energy incremental shift of this dataset  (default: 0.0)
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"><SPAN style="font-family:monospace">kind=</SPAN><B>7: Variable damping width of R-matrix term:</B>
<BR><SPAN style="font-family:monospace">term</SPAN>: term (default 1). For the real energy there should be a <SPAN style="font-family:monospace">kind</SPAN>=3 variable with the same <SPAN style="font-family:monospace">term</SPAN>.
<BR><SPAN style="font-family:monospace">damp</SPAN>:  Imaginary width (cm MeV in entrance channel) of this R-matrix term (default 0). 
<BR>
When <SPAN style="font-family:monospace">energy</SPAN> is  set, use the (real)  <SPAN style="font-family:monospace">leff</SPAN> to rescale the damping width according to energy above threshold <SPAN style="font-family:monospace">energy</SPAN> 
    by the penetrability ratio <!-- MATH
 $P_{\rm leff}(E - {\tt energy})/P_{\rm leff}(e_{\rm pole} - {\tt energy})$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img259.svg"
 ALT="$P_{\rm leff}(E - {\tt energy})/P_{\rm leff}(e_{\rm pole} - {\tt energy})$"></SPAN>, with elastic Coulomb. 
    If not set, use constant damping widths as  2*imaginary parts of the pole energies. 
<BR>
The <SPAN style="font-family:monospace">damp</SPAN> variable in <SPAN style="font-family:monospace">kind</SPAN>=3 is fixed, but those in <SPAN style="font-family:monospace">kind</SPAN>=7 can be varied in searches.
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE">Repeated <SPAN style="font-family:monospace">ndatasets</SPAN> times, namelist with some of the following variables, then the
corresponding data:
</SPAN></SPAN><PRE>
Card 3: (namelist: 'data')
type,data_file,points,delta,xmin,lab,energy,angle,
idir,iscale,abserr,ic,ia,k,q,jtot,par,channel,value,error,leg,
pel,exl,labe,lin,lex,term
</PRE><SPAN CLASS="SPAN"><SPAN CLASS="LARGE">
</SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE">8ex1
<SPAN style="font-family:monospace">type</SPAN> (default 0)

<BR>= &ndash;3 Legendre coefficient for input energy and fixed order <SPAN style="font-family:monospace">leg</SPAN>

<BR>= &ndash;2 Legendre coefficient (integer order <SPAN style="font-family:monospace">leg</SPAN>) for input energy: double distribution

<BR>= &ndash;1 Legendre coefficient for varying integer order <SPAN style="font-family:monospace">leg</SPAN>, for fixed energy

<BR>= 0 angular distribution for fixed energy

<BR>= 1 excitation and angular cross section double distributions

<BR>= 2 excitation cross section for fixed angle

<BR>= 3 excitation total cross section. Also: ic=0: <SPAN style="font-family:monospace">ia</SPAN>=0 is total reaction cross section;
<SPAN style="font-family:monospace">ia</SPAN>=1 is total fusion cross section; 1<SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img12.svg"
 ALT="$&lt;$"></SPAN><SPAN style="font-family:monospace">ia</SPAN><SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img12.svg"
 ALT="$&lt;$"></SPAN>NFUS+1 are fusion from potential
KFUS (on Card 5) for inelastic state <SPAN style="font-family:monospace">ia</SPAN>&ndash;1.

<BR>= 4 excitation phase shift for fixed partial wave

<BR>= 5 desired factor for bound state search (binding energy or potential scale
 according to ISC).

<BR>= 6 specific experimental constraint on a search parameter <SPAN style="font-family:monospace">par</SPAN>,
    to be <SPAN style="font-family:monospace">value</SPAN> with error <SPAN style="font-family:monospace">error</SPAN> (<SPAN style="font-family:monospace">abserr</SPAN>=T or F).

<BR>= 7 specific constraint on energy of R-matrix pole <SPAN style="font-family:monospace">term</SPAN> in the Brune basis 
    to be <SPAN style="font-family:monospace">value</SPAN> with error <SPAN style="font-family:monospace">error</SPAN> (<SPAN style="font-family:monospace">abserr</SPAN>=T or F).

<BR>= 8 specific constraint on total formal width of R-matrix pole <SPAN style="font-family:monospace">term</SPAN> in the Brune basis 
    to be <SPAN style="font-family:monospace">value</SPAN> with error <SPAN style="font-family:monospace">error</SPAN> (<SPAN style="font-family:monospace">abserr</SPAN>=T or F).
</SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"><SPAN style="font-family:monospace">data_file</SPAN>: name of data file with data, `<SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img60.svg"
 ALT="$=$"></SPAN>' for <SPAN style="font-family:monospace">search_file</SPAN>,
 `<SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img12.svg"
 ALT="$&lt;$"></SPAN>' for stdin (default `<SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img60.svg"
 ALT="$=$"></SPAN>')
<BR><SPAN style="font-family:monospace">points</SPAN>: number of data points (default: keep reading as many as possible),

<BR><SPAN style="font-family:monospace">delta</SPAN>: if non-zero, construct linear x-scale from <SPAN style="font-family:monospace">xmin</SPAN> in steps of <SPAN style="font-family:monospace">delta</SPAN>,
 (default 0)
<BR><SPAN style="font-family:monospace">lab</SPAN>: T  for lab angles and cross sections (default F for cm frame).
<BR><SPAN style="font-family:monospace">Aflip</SPAN>: T to change cm calculated angles to <SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img67.svg"
 ALT="$180-\theta$"></SPAN> (default F).
<BR><SPAN style="font-family:monospace">energy</SPAN>: lab energy for this <SPAN style="font-family:monospace">type</SPAN>=0 dataset (default: use <SPAN style="font-family:monospace">ELAB(1)</SPAN> from Card 19)
<BR><SPAN style="font-family:monospace">pel,exl,labe,lin,lex</SPAN>: specify input channels for this data set, as in Card 18
</SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE">8ex1
<SPAN style="font-family:monospace">idir</SPAN> (default 0)

<BR>=-1 cross-section data are given as astrophysical S-factors, but will be converted to absolute,

<BR>= 0 cross-section data are given in absolute units,

<BR>= 1 cross-section data are ratio to Rutherford

<BR>= 2 cross sections are given in absolute units but will be
         converted to ratio to rutherford.
</SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE">8ex1
<SPAN style="font-family:monospace">iscale</SPAN> (default 2)

<BR>= -1 dimensionless (eg ratio to rutherford if <SPAN style="font-family:monospace">idir</SPAN>=1),

<BR>= 0 absolute cross-section units are fermi-squared/sr.

<BR>= 1 absolute scale is barn/sr

<BR>= 2 absolute scale is mb/sr

<BR>= 3 absolute scale is micro-b/sr
</SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"><SPAN style="font-family:monospace">abserr</SPAN>: T or F for absolute error (default F)
<BR><SPAN style="font-family:monospace">ic</SPAN>: partition number of cross section channel (index of Cards 6)  (default 1)
<BR><SPAN style="font-family:monospace">ia</SPAN>: excitation pair number of cross section (index of Cards 7)  (default 1)
<BR><SPAN style="font-family:monospace">k</SPAN>: tensor rank of cross section (0, 1, 2,..) (default 0). 
<BR><SPAN style="font-family:monospace">q</SPAN>: index for tensor <SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img260.svg"
 ALT="$T_{kq}$"></SPAN> of cross section (0, 1, 2,..) (default 0).
    <SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img261.svg"
 ALT="$T_{00}$"></SPAN> = angular distribution <!-- MATH
 $\sigma(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img262.svg"
 ALT="$\sigma(\theta)$"></SPAN>.
<BR><SPAN style="font-family:monospace">jtot</SPAN>: The <SPAN style="font-family:monospace">J</SPAN> value (as on Card 2) for phase shift
<BR><SPAN style="font-family:monospace">par</SPAN>: The parity (&ndash;1 or +1) for phase shift, for <SPAN style="font-family:monospace">type</SPAN>=4
<BR><SPAN style="font-family:monospace">par</SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or number of search parameter, for <SPAN style="font-family:monospace">type</SPAN>=6.
<BR><SPAN style="font-family:monospace">channel</SPAN>: Channel number of entrance channel in coupled channels set (default 1),
for phase shift
<BR><SPAN style="font-family:monospace">value</SPAN>: Value of search parameter, for <SPAN style="font-family:monospace">type</SPAN>=6
<BR><SPAN style="font-family:monospace">error</SPAN>: Error in value of search parameter, for <SPAN style="font-family:monospace">type</SPAN>=6
<BR>&nbsp;
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE">2ex1
<B>Data input</B> (free format):

<BR>
if <SPAN style="font-family:monospace">type</SPAN>=1 or &ndash;2, read:  <SPAN style="font-family:monospace">energy, angle, value, error</SPAN>

<BR>
if <SPAN style="font-family:monospace">type</SPAN>=5, read:  <SPAN style="font-family:monospace">kn, target, error</SPAN>

<BR>&nbsp;&nbsp;&nbsp;&nbsp;otherwise:

<BR>
if <SPAN style="font-family:monospace">delta</SPAN><SPAN CLASS="MATH"><IMG
 STYLE=""
 SRC="img59.svg"
 ALT="$\ne$"></SPAN>0, read:  <SPAN style="font-family:monospace">value, error</SPAN>

<BR>
if <SPAN style="font-family:monospace">delta</SPAN>=0, read:  <SPAN style="font-family:monospace">x, value, error</SPAN>
</SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where <SPAN style="font-family:monospace">x</SPAN> is angle for <SPAN style="font-family:monospace">type</SPAN>=0, is <SPAN style="font-family:monospace">leg</SPAN> for <SPAN style="font-family:monospace">type</SPAN>=&ndash;1 or &ndash;2, and lab energy for <SPAN style="font-family:monospace">type</SPAN>=&ndash;3, 2, 3 and 4.
<BR></SPAN></SPAN>
<P>
<SPAN CLASS="SPAN"><SPAN CLASS="LARGE"></SPAN></SPAN>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A ID="tex2html94"
  HREF="node19.html"><SPAN style="font-family:monospace">SFresco</SPAN> Input</A>
</UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node19.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="frescox-input-manual.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node17.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A
 HREF="node19.html">SFresco Input</A>
<B> Up:</B> <A
 HREF="frescox-input-manual.html">Fresco</A>
<B> Previous:</B> <A
 HREF="node17.html">Appendix V : KIND=1</A></DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
